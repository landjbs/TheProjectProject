{% extends "home_base.html" %}
{% block title %}Search{% endblock %}

{% block head %}
  {{ super() }}
  <link type="text/css" href="css/scroll_styles.css" rel="stylesheet">
  <link rel='stylesheet' href="css/badge_styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
{% endblock %}

{% block content %}
<div class='container my-2' style='min-width: 90%'>
  <h4 style='text-align:left;'>Results for "{{ search_text }}"</h4>
  <hr class="my-2">
  {% if project_tabs!=[] %}
    <h4 style='text-align:left;'>Projects</h4>
    <hr class="my-2">
    <div id="project-carousel" class="carousel slide carousel-multi-item" data-ride="carousel">
      <!--Slides-->
      <div class="carousel-inner" role="listbox">
        {% for tab in project_tabs %}
          {% if loop.index==1 %}
          <div class="carousel-item active">
          {% else %}
          <div class="carousel-item">
          {% endif %}
            <div class='row'>
              {% for project in tab %}
                {{ macros.render_big_project_card(current_user, project, now, calc_days_since) }}
              {% endfor %}
            </div>
          </div>
        {% endfor %}
      </div>
      <!--Controls-->
      <div class="controls-top">
        <a class="btn-floating" href="#project-carousel" data-slide="prev"><i class="fa fa-chevron-circle-left fa-lg"></i></a>
        <p id='project-count' class='counter'>0</p>
        <a class="btn-floating" href="#project-carousel" data-slide="next"><i class="fa fa-chevron-circle-right fa-lg"></i></a>
      </div>
      <!--/.Controls-->
    </div>
  {% endif %}

  {% if user_tabs!=[] %}
    <div id="user-carousel" class="carousel slide carousel-multi-item" data-ride="carousel">
      <h4 style='text-align:left;'>Users</h4>
      <hr class="my-2">
      <div class="carousel-inner" role="listbox">
        {% for tab in user_tabs %}
          {% if loop.index==1 %}
          <div class="carousel-item active">
          {% else %}
          <div class="carousel-item">
          {% endif %}
            <div class='row'>
              {% for user in tab %}
                {{ macros.render_user_card(current_user, user) }}
              {% endfor %}
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
    <!--Controls-->
    <div class="controls-top">
      <a class="btn-floating" href="#user-carousel" data-slide="prev"><i class="fa fa-chevron-circle-left fa-lg"></i></a>
      <p id='user-count' class='counter'>0</p>
      <a class="btn-floating" href="#user-carousel" data-slide="next"><i class="fa fa-chevron-circle-right fa-lg"></i></a>
    </div>
    <!--/.Controls-->
  {% endif %}

  {% if subject_tabs!=[] %}
      <h4 style='text-align:left;'>Subjects</h4>
      <hr class="my-2">
      <div id="subject-carousel" class="carousel slide carousel-multi-item" data-ride="carousel">
        <!--Slides-->
        <div class="carousel-inner" role="listbox">
          {% for tab in subject_tabs %}
            {% if loop.index==1 %}
            <div class="carousel-item active">
            {% else %}
            <div class="carousel-item">
            {% endif %}
              <div class='row'>
                {% for subject in tab %}
                  {{ macros.render_subject_card(subject) }}
                {% endfor %}
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
    <!--Controls-->
    <div class="controls-top">
      <a class="btn-floating" href="#subject-carousel" data-slide="prev"><i class="fa fa-chevron-circle-left fa-lg"></i></a>
      <p id='subject-count' class='counter'>0</p>
      <a class="btn-floating" href="#subject-carousel" data-slide="next"><i class="fa fa-chevron-circle-right fa-lg"></i></a>
    </div>
    <!--/.Controls-->
  {% endif %}

<!-- modals -->
<div>
  <!-- project modals -->
  {% for tab in project_tabs %}
    {% for project in tab %}
      {{ macros.render_join_modal(current_user, project, project_application) }}
    {% endfor %}
  {% endfor %}
  <!-- user modals -->
  {% for tab in user_tabs %}
    {% for user in tab %}
      {{ macros.render_collaborate_modal(current_user, user) }}
      {% if not user==current_user %}
        {{ macros.render_report_modal(user) }}
      {% endif %}
    {% endfor %}
  {% endfor %}

</div>



<script>
// log tabs
$('#project-carousel').on('slid.bs.carousel', function () {
  var cur = $('#project-carousel div.active').index();
  sessionStorage.setItem('recSlide', cur);
  $('#project-count').html(cur);
  });

$('#user-carousel').on('slid.bs.carousel', function () {
  var cur = $('#user-carousel div.active').index();
  sessionStorage.setItem('trendingSlide', cur);
  $('#user-count').html(cur);
  });

$('#subject-carousel').on('slid.bs.carousel', function () {
  var cur = $('#subject-carousel div.active').index();
  sessionStorage.setItem('mySlide', cur);
  $('#subject-count').html(cur);
  });

// rescroll carousels
if(sessionStorage.recSlide){
    $("#project-carousel").carousel(sessionStorage.recSlide*1);
  }

if(sessionStorage.trendingSlide){
    $("#user-carousel").carousel(sessionStorage.trendingSlide*1);
  }

if(sessionStorage.mySlide){
    $("#subject-carousel").carousel(sessionStorage.mySlide*1);
  }
</script>


{% endblock %}
