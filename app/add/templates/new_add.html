{% extends "home_base.html" %}
{% from 'macros/forms/field.html' import render_field %}
{% from 'macros/forms/fragment.html' import render_fragment %}

{% block title %}Add Project{% endblock %}

{% block head %}
  {{ super() }}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- custom stylesheets -->
  <link type="text/css" href="/css/add_styles.css" rel="stylesheet">
  <!-- <link type="text/css" href="/css/form_styles.css" rel="stylesheet"> -->
  <link type='text/css' href='/css/select_styles.css' rel='stylesheet'>
  <link type='text/css' href='/css/slider_styles.css' rel='stylesheet'>
{% endblock %}

{% block content %}
<form class='big-box container justify-content-center' id='add_form'>
  <div class='formelts'>
    {{ form.csrf_token() }}
    {{ render_fragment(form) }}
  </div>

  <!-- temp navigator -->
  <p class='float-left'>
    <span id='form_time_inc'>{{ form.total_time() }}</span>
    seconds remaining
  </p>
  <div style="overflow:auto; width:95%;">
    <div style="float:right;">
      <button class='formtab_button' type="button" id="prevBtn" onclick="nextPrev(-1)">Back</button>
      <button class='formtab_button' type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>
    </div>
  </div>
</form>

<script src='js/form.js'></script>

<script>
  function submit() {
    document.getElementById("add_form").submit();
  };

  var currentTab = 0; // Current tab is set to be the first tab (0)
  showTab(currentTab); // Display the current tab

  $(document).keydown(function(e) {
    var field = getCurrentTab();
    var field_type = field.getAttribute('data-field-type');
    field_keydown(e, field);
  })

  $(document).ready(function() {
    $('form').submit(function (e) {
        var url = Flask.url_for('add.next_fragement');
        $.ajax({
            type: "POST",
            url: url,
            data: $('form').serialize(), // serializes the form's elements.
            success: function (data) {
                console.log(data)  // display the returned data in the console.
            }
        });
        e.preventDefault(); // block the traditional submission of the form.
    });

    // Inject our CSRF token into our AJAX request.
    $.ajaxSetup({
        beforeSend: function(xhr, settings) {
            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", "{{ form.csrf_token._value() }}")
            }
        }
        })
    });

</script>
{% endblock %}


<!-- $(document).keydown(function(e) {
  // tab is clicked
  if (e.keyCode==9) {
    // shift is also down = backward
    if (e.shiftKey) {
      e.preventDefault();
      nextPrev(-1);
    }
    // just tab = forward
    else {
      e.preventDefault();
      nextPrev(1);
    }
  }
  else if (e.keyCode==13) {
    nextPrev(1);
  }
  else if (e.keyCode==89) {
    // WARNING: CHANGE TO BE ON BOOLEAN FIELD TAB IF NUM FIELDS CHANGES
    if (currentTab==4) {
      $('input[type="radio"]').not(':checked').prop("checked", true);
    }
  }
}); -->
