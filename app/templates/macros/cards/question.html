{% macro render_add_question_card(project_id) -%}
  {% set cover_id = 'Question_Cover'.format(fname=name) %}
  {% set input_id = 'Question_Input'.format(fname=name) %}
  <div id='ask-question-card' class='card mb-2'>
    <div class='card-body card-cover' id='{{ cover_id }}' onclick="toggleInput('{{ cover_id }}','{{ input_id }}')" style='color:black; text-align:center;'>
      <i class="fas fa-question-circle fa-2x"></i>
      <h5>Add A Question</h5>
    </div>
    <div class='card-body' id='{{ input_id }}' style='color:black; text-align:center; display:none;'>
      <center><i class="fas fa-question-circle" style='display:inline;'></i></center>
      <form id='ask-question-form'>
        <label for="question">Question:</label>
        <input id='ask-question-form-question' type="text" name="question" list="question_suggestions" class='select-clean'
          required>
        <datalist id="question_suggestions">
          {% for question in g.project.suggest_questions() %}
            <option value='{{ question }}'>
          {% endfor %}
        </datalist>
        <br><br>
        {% if g.project.is_member(g.current_user) %}
          <label for="answer">Answer:</label>
          <input id='ask-question-form-answer' type='text' name='answer' class='select-clean'></input>
        {% endif %}
        <div class='float-right'>
          <button class='complete-btn task-btn float-right' type='submit' style='background:transparent;border:0px;margin-bottom:0px; display:inline-block;'>
              <i class="fa fa-check-circle" aria-hidden="true"></i>
          </button>
        </div>
      </form>
    </div>
  </div>
  <!-- listener for form submit todo: move to cardbox.js -->
  <script>
    ask_form = document.getElementById('ask-question-form');
    ask_form.addEventListener('submit', function (e) {
      url = Flask.url_for(
              'project.add_question',
              {'project_id'    :   String('{{ project.id }}')}
      );
      ask_form = document.getElementById('ask-question-form');
      question = document.getElementById('ask-question-form-question');
      answer = document.getElementById('ask-question-form-answer');
      // json question only if no answer else both
      if (answer==null) {
        data = JSON.stringify({'question' : question.value});
      }
      else {
        data = JSON.stringify({
          'question'  :   question.value,
          'answer'    :   answer.value
        });
      }
      // submit ajax
      $.ajax({
        type        :     'POST',
        url         :     url,
        dataType    :     'json',
        contentType :     'application/json',
        data        :     data
      }).done(
        function (payload) {
          if (payload['success']==true) {
            // WARNING: relies on questions in cardbox with postfix=questions
            question_list = document.getElementById('cardbox-list-questions');
            question_list.innerHTML += payload['html'];
            question.value = '';
            answer.value = '';
          } else {
            document.getElementById('ask-question-card').style['border-color'] = 'red';
          }
        }
      );
      // prevent default submission
      e.preventDefault();
    });
  </script>
{% endmacro -%}


{% macro render_question_card(question) -%}
  {{ question.project.name }}
{% endmacro -%}
