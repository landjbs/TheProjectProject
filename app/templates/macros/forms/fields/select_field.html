{% from 'macros/carousels.html' import render_carousel with context -%}


<!-- this maybe should still be preserved for competitions -->
<!-- warning not implemented yet -->
{% macro render_searchable_select_field(field) -%}
  {{ field(class='input add-select', style='display: none;') }}
  <div class='col' id='searchableOptions-{{ field.id }}'>
    <span style='display:inline-block;'>
      <p>
        <u>Options (scroll for more)</u>
        <i class="fas fa-search"></i>
        <input class='select-clean' style='font-size:100%; width:30%;' type="text" placeholder="search..." id="optionSearch-{{ field.id }}" onkeyup="filterFunction('optionSearch-{{ field.id }}', 'searchableOptions-{{ field.id }}')">
      </p>
    </span>
  </div>
  <div id='competitions' class='glider'>
    {% for id, option in field.choices %}
      {% if not option=='' %}
        <div class="card mb-2" style='color: white; background: black; margin-left: 10px; margin-right: 10px; border: 1px solid white;'>
          <div class="card-body">
              {{ option }}
          </div>
          <div class='card-foot' style='padding-bottom: 10px;'>
            <button class='formtab_button' type="button" onclick="select_option('{{ id }}')">
              <span id='check-{{ id }}' class='presskey' style='margin-bottom:1px;'>
              </span>
              <span id='text-{{ id }}'>Join</span>
            </button>
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
  <div id='dots' role="tablist" class="dots"></div>
  <script>
  new Glider(document.querySelector('#competitions'), {
    // slidesToShow: parseInt($('#n_to_show_{').data()['other']),
    slidesToShow: 3,
    slidesToScroll: 1,
    // speed aggravator - higher is slower
    duration: .5,
    draggable: false,
    rewind: true,
    dots: '#dots'
    });
  </script>
  <script>
    function select_option(id) {
      document.getElementById('check-' + id).innerHTML = '<i class="fas fa-check"></i>';
      document.getElementById('text-' + id).innerHTML = 'Withdraw';
    }
  </script>
{% endmacro -%}


{% macro render_select_field(field) -%}
  {% if field.render_kw.get('searchable')==true %}
    {{ render_searchable_select_field(field) }}
  {% else %}
    <div class='input-control select_field' id='{{ field.id }}'>
      {% for i, name in field.choices %}
        {% set data = field.render_kw['datamap'][i] %}
        {% set action = data['action'] %}
        <input id="{{ name }}-{{ field.id }}" class="toggle" name="{{ field.name }}" value='{{ i }}' type="radio" data-key="{{ data['key'] }}" onclick="{{ data['action'] }}">
        <label for="{{ name }}-{{ field.id }}" class="btn">
          <i class="{{ data['icon'] }} fa-2x"></i>
          <br>
          <span class='presskey'>
            {{ data['key'] }}
          </span>
          {{ name }}
        </label>
      {% endfor %}
    </div>
  {% endif -%}
{% endmacro -%}
