{% macro render_join_modal(current_user, project) -%}

    {% if not is_project_member(current_user, project) %}
      <div id="modal_{{ project.id }}" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <a href='project={{ project.name }}' style='color:black;'>
                <h5>{{ project.name }}</h5>
              </a>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <form action="{{ url_for('join_project', project_id=project.id) }}" method='post'>
              <div class="modal-body">
                {% if project.requires_application %}
                  "{{ project.application_question }}"</p>
                    {{ project_application.hidden_tag() }}
                    {{ project_application.response(class='join-input', placeholder='Response', required=True) }}
                {% else %}
                  <p>Welcome to {{ project.name }}! Click to join.</p>
                {% endif %}
              </div>
              <div class="modal-footer">
                <button class='btn'>Join</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    {% else %}
      <div id="modal_{{ project.id }}" class="modal fade" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <a href='project={{ project.name }}' style='color:black;'>
                <h5>{{ project.name }}</h5>
              </a>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <form action="{{ url_for('leave_project', project_id=project.id) }}" method='post'>
                <div class="modal-body">
                  {% if project.owner==current_user %}
                    {% if project.members.all()|length>1 %}
                      <label for="new_owner">Select new project owner:</label>
                      <br>
                      <select name="new_owner" id="new_owner" style='border:0px; border-bottom:1px solid black; width:100%;'>
                        {% for member in project.members %}
                          {% if not member==project.owner %}
                            <option value="{{ member.id }}">{{ member.name }}</option>
                          {% endif %}
                        {% endfor %}
                      </select>
                    {% else %}
                      <p>
                        If you leave {{ project.name }}, there will be no members left and the
                        project will be deleted. Are you sure you want to leave?
                      </p>
                    {% endif %}
                  {% else %}
                    <p>Are you sure you want to leave {{ project.name }}?</p>
                  {% endif %}
                </div>
                <div class="modal-footer">
                  <button class='btn'>Leave</button>
                </div>
              </form>
          </div>
        </div>
      </div>
    {% endif %}
  </div>


{%- endmacro %}
